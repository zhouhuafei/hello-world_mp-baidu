# 打包
* 微信小程序打包成开发环境的代码
```
npm run weixinDev
```
* 微信小程序打包成生产环境的代码
```
npm run weixinBuild
```
* 百度小程序打包成开发环境的代码
```
npm run baiduDev
```
* 百度小程序打包成生产环境的代码
```
npm run baiduBuild
```
* 统一生产 - 百度小程序和微信小程序都打成生产环境的代码
```
npm run build
```
* 统一开发 - 无法在开发时进行统一监听，请开多个命令行窗口进行多次监听。案例如下：
    - 命令行窗口1运行微信小程序开发时的监听：
    ```
    npm run weixinDev
    ```
    - 命令行窗口2运行百度小程序开发时的监听：
    ```
    npm run baiduDev
    ```

# 注意事项
* 清理dist/baidu目录时，请不要删掉project.swan.json和pkginfo.json文件。可以保留配置好的编译模式。
* 清理dist/weixin目录时，请不要删掉project.config.json文件。可以保留配置好的编译模式。
* 注释不能乱删！注释不能乱删！注释不能乱删！有些注释在打包后是有用途的！请看下面的大标题```从注释里提取代码```。

# 预言家
* 我预言：需要login授权页（授权之后，应该根据唯一标识进行手动登录一次，如此可以保证账号统一），这样后续改造为微信小程序，支付宝小程序，今日头条小程序可能会方便点。
* 我觉的登录应该重构。没登录的应该统一到登录页进行登录。

# css
* ```g-```开头的css，表示全站通用的样式，请谨慎修改。

# controllers
* 目的是为了对接口返回的数据进行二次修改。

# 问题
* wxRequest中配置目前是写死的。需要读取ext.json。但是百度小程序目前不支持。
    - 解决方案：百度小程序用ext.js。然后不同的项目，写不同的代码，通过注释去提取。
* 开发环境和生产环境域名不同，以前的某些代码需要修改。
    - 凡是用到weishangye域名的都需要从配置里读取域名。不能直接写死。
    - webview中，有段正则匹配用到了域名，那段代码是针对线上环境的，如果是开发环境，则要单独处理。不处理也行，无非是开发环境会有点问题。后续web-view都应该被迭代掉。

# 从注释里提取代码
* js书写格式：双反斜杠+空格+baidu-valid+空格+js代码
```
// baidu-valid var a=1; // 这句代码表示百度小程序才会生效
// weixin-valid var a=1; // 这句代码表示微信小程序才会生效
// production-valid var a=1; // 这句代码表示微信小程序才会生效
// development-valid var a=1; // 这句代码表示微信小程序才会生效
```
* 如果不想从注释里提取代码，可以通过config.api_type判断类型。从而实现不同小程序执行不同的代码。
